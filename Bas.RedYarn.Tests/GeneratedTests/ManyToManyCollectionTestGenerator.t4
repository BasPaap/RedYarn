<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ assembly name="System.Runtime" #>
<#@ assembly name="$(SolutionDir)\Bas.RedYarn\bin\Debug\netcoreapp2.0\Bas.RedYarn.dll" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="Bas.RedYarn" #>
<#@ output extension=".cs" #><#+
private void WriteBeginning(string unitUnderTestName)
{
#>
//------------------------------------------------------------------------------ 
// <auto-generated> 
// This code was generated by a tool. 
// 
// Changes to this file may cause incorrect behavior and will be lost if 
// the code is regenerated. 
// </auto-generated> 
//------------------------------------------------------------------------------

using Bas.RedYarn.Helpers;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Bas.RedYarn
{
    public partial class <#= unitUnderTestName #>Test
    {
<#+
}

private void WriteEnd()
{
#>
	}
}
<#+
}

private void WriteTests(string unitUnderTestName, string relatedObjectName, string collectionOnTestedObjectPropertyName, string collectionOnRelatedObjectPropertyName)
{
#>
		#region <#= collectionOnTestedObjectPropertyName #> property
        [TestMethod]
        public void <#= collectionOnTestedObjectPropertyName #>Add_New<#= relatedObjectName #>_<#= unitUnderTestName #>Contains<#= relatedObjectName #>()
        {
            var <#= relatedObjectName.ToLower() #> = new <#= relatedObjectName #>() { Name = "<#= relatedObjectName #>" };
            ManyToManyCollectionHelper.CollectionAdd_NewItem_RelatedCollectionContainsThis(this.<#= unitUnderTestName.ToLower() #>, <#= relatedObjectName.ToLower() #>, this.<#= unitUnderTestName.ToLower() #>.<#= collectionOnTestedObjectPropertyName #>, <#= relatedObjectName.ToLower() #>.<#= collectionOnRelatedObjectPropertyName #>);
        }

        [TestMethod]
        public void <#= collectionOnTestedObjectPropertyName #>Insert_New<#= relatedObjectName #>_<#= unitUnderTestName #>Contains<#= relatedObjectName #>()
        {
            var <#= relatedObjectName.ToLower() #> = new <#= relatedObjectName #>() { Name = "<#= relatedObjectName #>" };
            ManyToManyCollectionHelper.CollectionInsert_NewItem_RelatedCollectionContainsThis(this.<#= unitUnderTestName.ToLower() #>, <#= relatedObjectName.ToLower() #>, this.<#= unitUnderTestName.ToLower() #>.<#= collectionOnTestedObjectPropertyName #>, <#= relatedObjectName.ToLower() #>.<#= unitUnderTestName #>s);
        }

        [TestMethod]
        public void <#= collectionOnTestedObjectPropertyName #>Clear_<#= relatedObjectName #>Contains<#= unitUnderTestName #>_<#= unitUnderTestName #>IsRemovedFrom<#= relatedObjectName #>()
        {
            var <#= relatedObjectName.ToLower() #> = new <#= relatedObjectName #>() { Name = "<#= relatedObjectName #>" };
            ManyToManyCollectionHelper.CollectionClear_TestedObjectCollectionContainsRelatedObject_TestedObjectIsRemovedFromRelatedCollection(this.<#= unitUnderTestName.ToLower() #>, <#= relatedObjectName.ToLower() #>, this.<#= unitUnderTestName.ToLower() #>.<#= collectionOnTestedObjectPropertyName #>, <#= relatedObjectName.ToLower() #>.<#= unitUnderTestName #>s);
        }

        [TestMethod]
        public void <#= collectionOnTestedObjectPropertyName #>Remove_<#= relatedObjectName #>Contains<#= unitUnderTestName #>_<#= unitUnderTestName #>IsRemovedFrom<#= relatedObjectName #>()
        {
            var <#= relatedObjectName.ToLower() #> = new <#= relatedObjectName #>() { Name = "<#= relatedObjectName #>" };
            ManyToManyCollectionHelper.CollectionRemove_TestedObjectCollectionContainsRelatedObject_TestedObjectIsRemovedFromRelatedCollection(this.<#= unitUnderTestName.ToLower() #>, <#= relatedObjectName.ToLower() #>, this.<#= unitUnderTestName.ToLower() #>.<#= collectionOnTestedObjectPropertyName #>, <#= relatedObjectName.ToLower() #>.<#= unitUnderTestName #>s);
        }

        [TestMethod]
        public void <#= collectionOnTestedObjectPropertyName #>RemoveAt_<#= relatedObjectName #>Contains<#= unitUnderTestName #>_<#= unitUnderTestName #>IsRemovedFrom<#= relatedObjectName #>()
        {
            var <#= relatedObjectName.ToLower() #> = new <#= relatedObjectName #>() { Name = "<#= relatedObjectName #>" };
            ManyToManyCollectionHelper.CollectionRemoveAt_TestedObjectCollectionContainsRelatedObject_TestedObjectIsRemovedFromRelatedCollection(this.<#= unitUnderTestName.ToLower() #>, <#= relatedObjectName.ToLower() #>, this.<#= unitUnderTestName.ToLower() #>.<#= collectionOnTestedObjectPropertyName #>, <#= relatedObjectName.ToLower() #>.<#= unitUnderTestName #>s);
        }

        [TestMethod]
        public void <#= collectionOnTestedObjectPropertyName #>Set_<#= relatedObjectName #>Contains<#= unitUnderTestName #>_<#= unitUnderTestName #>IsRemovedFromOld<#= relatedObjectName #>AndAddedToNew<#= relatedObjectName #>()
        {
            var <#= relatedObjectName.ToLower() #> = new <#= relatedObjectName #>() { Name = "<#= relatedObjectName #>" };
            var new<#= relatedObjectName #> = new <#= relatedObjectName #>() { Name = "New<#= relatedObjectName #>" };

            ManyToManyCollectionHelper.CollectionSet_TestedObjectCollectionContainsRelatedObject_TestedObjectIsReplacedInRelatedCollection(this.<#= unitUnderTestName.ToLower() #>, <#= relatedObjectName.ToLower() #>, new<#= relatedObjectName #>, this.<#= unitUnderTestName.ToLower() #>.<#= collectionOnTestedObjectPropertyName #>, <#= relatedObjectName.ToLower() #>.<#= unitUnderTestName #>s, new<#= relatedObjectName #>.<#= unitUnderTestName #>s);
        }
        #endregion	

<#+
}
#>